<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="turbo-prefetch" content="false" />
    <title>
      {% block title %}
        EDT Manager
      {% endblock %}
    </title>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>ðŸ“…</text></svg>" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" />

    <!-- CSS personnalisÃ© -->
    <link rel="stylesheet" href="{{ asset('styles/style.css') }}" />

    {% block stylesheets %}
    {% endblock %}

    <style>
      /* Reset des marges pour Ã©viter les espaces au-dessus de la navbar */
      body {
        margin: 0 !important;
        padding: 0 !important;
      }
      
      .navbar {
        margin-top: 0 !important;
      }
      
      /* Compensation pour le contenu sous la navbar sticky */
      .app-main {
        padding-top: 0;
      }
    </style>
  </head>
  <body class="app-container">
    <!-- Navigation principale sticky -->
    {% include '_partials/header.html.twig' %}

    <!-- Messages flash -->
    <div id="flash" class="flash-messages">
      {% include '_partials/flash.stream.twig' %}
    </div>

    <!-- Contenu principal -->
    <main class="app-main">
      {% block body %}
      {% endblock %}
    </main>

    <!-- Scripts -->
    {% block javascript %}
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
      {{ encore_entry_script_tags('app') }}

      <script>
        // Script pour gÃ©rer l'Ã©tat actif des onglets
        document.addEventListener('DOMContentLoaded', function () {
          const navTabs = document.querySelectorAll('.nav-tab')
        
          navTabs.forEach((tab) => {
            tab.addEventListener('click', function () {
              // Retirer la classe active de tous les onglets dans le mÃªme groupe
              const parent = this.closest('.tab-navigation') || this.closest('.main-navigation')
              if (parent) {
                parent.querySelectorAll('.nav-tab').forEach((t) => t.classList.remove('active'))
              }
              // Ajouter la classe active Ã  l'onglet cliquÃ©
              this.classList.add('active')
            })
          })
        
          // Marquer l'onglet actif au chargement de la page
          const currentPath = window.location.pathname
          navTabs.forEach((tab) => {
            if (tab.href && tab.href.includes(currentPath)) {
              tab.classList.add('active')
            }
          })
        
          // Auto-hide flash messages
          const flashMessages = document.querySelectorAll('.alert')
          flashMessages.forEach((message) => {
            setTimeout(() => {
              message.style.opacity = '0'
              message.style.transform = 'translateX(100%)'
              setTimeout(() => {
                message.remove()
              }, 300)
            }, 5000)
          })
        })
        
        // Fonction pour confirmer les suppressions
        function confirmDelete(message = 'ÃŠtes-vous sÃ»r de vouloir supprimer cet Ã©lÃ©ment ?') {
          return confirm(message)
        }
        
        // AmÃ©lioration des formulaires
        document.addEventListener('DOMContentLoaded', function () {
          // Auto-focus sur le premier input visible
          const firstInput = document.querySelector('input:not([type="hidden"]), select, textarea')
          if (firstInput && !firstInput.hasAttribute('autofocus')) {
            firstInput.focus()
          }
        
          // Validation en temps rÃ©el
          const inputs = document.querySelectorAll('input, select, textarea')
          inputs.forEach((input) => {
            input.addEventListener('blur', function () {
              if (this.checkValidity()) {
                this.classList.remove('is-invalid')
                this.classList.add('is-valid')
              } else {
                this.classList.remove('is-valid')
                this.classList.add('is-invalid')
              }
            })
          })
        })
      </script>
    {% endblock %}

    {% block extra_javascript %}
    {% endblock %}
  </body>
</html>

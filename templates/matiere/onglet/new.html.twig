<turbo-frame id="matiere_tray">
  <div class="form-wrapper">
    <!-- En-t√™te du formulaire -->
    <header class="form-header">
      <div class="form-icon">üìö</div>
      <h2 class="form-title">Cr√©er une Mati√®re</h2>
      <p class="form-subtitle">Ajoutez une nouvelle mati√®re avec sa couleur distinctive</p>
    </header>

    <!-- Messages flash -->
    {% for message in app.flashes('success') %}
      <div class="alert alert-success">
        <div class="alert-icon">üéâ</div>
        <div class="alert-content">{{ message }}</div>
      </div>
    {% endfor %}

    {% for message in app.flashes('error') %}
      <div class="alert alert-danger">
        <div class="alert-icon">‚ö†Ô∏è</div>
        <div class="alert-content">{{ message }}</div>
      </div>
    {% endfor %}

    <!-- Formulaire -->
    {{ form_start(form, { action: path('matiere_show', { nomOnglet: 'new' }), attr: { class: 'entity-form' } }) }}

    <div class="form-row">
      <div class="form-group">
        <div class="input-wrapper">
          <div class="input-icon">üè∑Ô∏è</div>
          {{ form_label(form.nom, 'Nom de la mati√®re', { attr: { class: 'form-label' } }) }}
          {{ form_widget(form.nom, { attr: { class: 'form-input', placeholder: 'Ex: Math√©matiques, Fran√ßais, Histoire...' } }) }}
          {{ form_errors(form.nom) }}
        </div>
      </div>

      <div class="form-group">
        <div class="input-wrapper">
          <div class="input-icon">üé®</div>
          {{ form_label(form.couleur, "Couleur d'identification", { attr: { class: 'form-label' } }) }}
          <div class="color-input-container">
            {{ form_widget(form.couleur, { attr: { class: 'form-input color-input', 'data-preview': 'true' } }) }}
            <div class="color-preview" id="colorPreview"></div>
          </div>
          <small class="form-text">Cette couleur sera utilis√©e dans les emplois du temps</small>
          {{ form_errors(form.couleur) }}
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="custom-btn custom-btn-primary">
        <span class="btn-icon">‚úÖ</span>
        Cr√©er la mati√®re
      </button>
    </div>

    {{ form_end(form) }}
  </div>

  <style>
    /* Styles sp√©cifiques pour le s√©lecteur de couleur */
    .color-input-container {
      position: relative;
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
    }
    
    .color-input {
      flex: 1;
      min-width: 0;
    }
    
    .color-preview {
      width: 60px;
      height: 45px;
      border: 2px solid var(--input-border);
      border-radius: var(--border-radius-md);
      background: linear-gradient(45deg, #f0f0f0 25%, transparent 25%), linear-gradient(-45deg, #f0f0f0 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #f0f0f0 75%), linear-gradient(-45deg, transparent 75%, #f0f0f0 75%);
      background-size: 8px 8px;
      background-position: 0 0, 0 4px, 4px -4px, -4px 0px;
      transition: all var(--transition-normal);
      position: relative;
      overflow: hidden;
    }
    
    .color-preview::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #3498db;
      transition: background-color var(--transition-normal);
    }
    
    .form-text {
      color: var(--text-muted);
      font-size: 0.85rem;
      margin-top: var(--spacing-xs);
      font-style: italic;
    }
    
    /* Am√©lioration du input couleur */
    input[type='color'] {
      appearance: none;
      -webkit-appearance: none;
      border: none;
      width: 100%;
      height: 45px;
      background: none;
      cursor: pointer;
    }
    
    input[type='color']::-webkit-color-swatch-wrapper {
      padding: 0;
      border: none;
      border-radius: var(--border-radius-md);
      overflow: hidden;
    }
    
    input[type='color']::-webkit-color-swatch {
      border: none;
      border-radius: var(--border-radius-md);
    }
    
    input[type='color']::-moz-color-swatch {
      border: none;
      border-radius: var(--border-radius-md);
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const colorInput = document.querySelector('input[type="color"]')
      const colorPreview = document.getElementById('colorPreview')
    
      if (colorInput && colorPreview) {
        function updatePreview() {
          colorPreview.style.setProperty('--preview-color', colorInput.value)
          colorPreview.querySelector('::after, :after').style.backgroundColor = colorInput.value
        }
    
        // Mise √† jour initiale
        updatePreview()
    
        // Mise √† jour lors du changement
        colorInput.addEventListener('input', updatePreview)
        colorInput.addEventListener('change', updatePreview)
      }
    })
  </script>
</turbo-frame>
